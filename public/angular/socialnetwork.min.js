(function(){angular.module("socialnetworkApp",["ngRoute","ngSanitize","ui.bootstrap"]);function e(e,r){e.when("/",{templateUrl:"/home/home.view.html"}).when("/index",{templateUrl:"index/index.view.html",controller:"indexCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});r.html5Mode(true)}angular.module("socialnetworkApp").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("socialnetworkApp").controller("registerCtrl",e);e.$inject=["$scope","registerUser","geoLocation"];function e(e,r,t){var n=this;n.message="Checking your location";n.getData=function(e){var t=e.coords.latitude,o=e.coords.longitude;n.message="Searching for nearby places";var i;i={name:n.register.name,firstname:n.register.firstname,lastname:n.register.lastname,email:n.register.email,password:n.register.password,lat:t,lng:o};r.register(t,o,i).success(function(e){n.message="User Create";alert("USUARIO CREADO")}).error(function(e){n.message="Sorry, something's gone wrong, please try again later"})};n.showError=function(r){e.$apply(function(){n.message=r.message})};n.noGeo=function(){e.$apply(function(){n.message="Geolocation is not supported by this browser."})};n.registerSubmit=function(){t.getPosition(n.getData,n.showError,n.noGeo)}}})();(function(){angular.module("socialnetworkApp").service("geolocation",e);function e(){var e=function(e,r,t){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(e,r)}else{t()}};return{getPosition:e}}})();(function(){angular.module("socialnetworkApp").service("registerUser",e);e.$inject=["$http"];function e(e){var r=function(r,t,n){return e.post("/api/users/create",JSON.stringify(n))};return{register:r}}})();(function(){angular.module("socialnetworkApp").service("authentication",e);e.$inject=["$http","$window"];function e(e,r){var t=function(e){r.localStorage["socialnetwork-token"]=e};var n=function(){return r.localStorage["socialnetwork-token"]};var o=function(){var e=n();if(e){var t=JSON.parse(r.atob(e.split(".")[1]));return t.exp>Date.now()/1e3}else{return false}};var i=function(){if(o()){var e=n();var t=JSON.parse(r.atob(e.split(".")[1]));return{email:t.email,name:t.name}}};register=function(r){return e.post("/api/register",r).success(function(e){t(e.token)})};login=function(r){return e.post("/api/login",r).success(function(e){t(e.token)})};logout=function(){r.localStorage.removeItem("socialnetwork-token")};return{currentUser:i,saveToken:t,getToken:n,isLoggedIn:o,register:register,login:login,logout:logout}}})();(function(){angular.module("socialnetworkApp").filter("formatDistance",r);var e=function(e){return!isNaN(parseFloat(e))&&isFinite(e)};function r(){return function(r){var t,n;if(r&&e(r)){if(r>1){t=parseFloat(r).toFixed(1);n="km"}else{t=parseInt(r*1e3,10);n="m"}return t+n}else{return"?"}}}})();(function(){angular.module("socialnetworkApp").directive("footerGeneric",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("socialnetworkApp").controller("indexCtrl",e);e.$inject=["$location","authentication"];function e(e,r){var t=this;t.pageHeader={title:"Sign in to Loc8r"};t.credentialsLogin={email:"",password:""};t.credentialsRegister={name:"",firstname:"",lastname:"",email:"",password:""};t.returnPage="/home";t.onSubmitLogin=function(){alert("hola");t.formError="";if(!t.credentialsLogin.email||!t.credentialsLogin.password){t.formError="All fields required, please try again";return false}else{t.doLogin()}};t.doLogin=function(){t.formError="";alert("hola");r.login(t.credentialsLogin).error(function(e){t.formError=e}).then(function(){e.search("page",null);e.path(t.returnPage)})};t.onSubmitRegister=function(){t.formError="";if(!t.credentialsRegister.name||!t.credentialsRegister.email||!t.credentialsRegister.password){t.formError="All fields required, please try again";return false}else{t.doRegister()}};t.doRegister=function(){t.formError="";r.register(t.credentialsRegister).error(function(e){t.formError=e}).then(function(){e.search("page",null);e.path(t.returnPage)})}}})();